<meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

<!----------------------------------- MAIN BODY -------------------------------------->

<head>
    <meta charset="UTF-8">
    <title>Search for COVID-19 results</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
</head>

<body>

<div class="container" id="uncertainty"><!--TITLE-->

    <div align="center">
        <br><h3>Semantic Search for COVID-19 Negative Cases</h3><br>
    </div>

    <!--Instructions-->
    <div class="row">
        <div class="col-xs-12 col-md-12 col-sm-12 col-xs-12">
            <div class="panel panel-success"><!--example heading-->
                <div class="panel-heading"><strong>How To Use</strong></div>
                <div class="panel-body">
                    <h5> <u>Instructions</u> </h5>
                    <p> We support two types of semantic search: <br/>
                        (1) Direct search: in this mode the system will return tweets that meet your searching constraints. For example, put a "boy" in "name" slot.<br/>
                        (2) Aggregated search: in this mode the system will return tweets that are merged by the slot you specify (using "*"). See examples below.</p>
                    <h5> <u>Sample Queries</u> </h5>
                    <p> Here we provide sample results for some example queries with methods to generate them.<br/>
                        Example 1. <a href="http://kb1.cse.ohio-state.edu:8000/covid19/examples/demo_negative_1" target="_blank">Who tested negative?</a> [This query is generated by putting "*" in "name" slot.]<br/>
{#                        2. <a href="http://kb1.cse.ohio-state.edu:8000/covid19/examples/positive_demo_2" target="_blank">Where did people test positive? </a> [This query is generated by putting "*" in "where" slot.]<br/>#}
{#                        2. <a href="http://kb1.cse.ohio-state.edu:8000/covid19/examples/positive_demo_3" target="_blank">Who tested positive that had close contact with Boris Johnson?</a> [This query is generated by putting "*" in "name" slot and "Boris Johnson" in "close contact" slot.] </p>#}
                    <h5> We recommend using Chrome to get our demo work properly. </h5>
                </div>
            </div>
        </div>
    </div>

<!--Instructions-->
    <div id="app">
        <div class="row">
            <div class="col-xs-12 col-md-12 col-sm-12 col-xs-12">
                <div class="panel panel-info"><!--example heading-->
                    <div class="panel-heading"><strong>Entering Your Searching Query...</strong></div>
                    <div class="panel-body">
                        <form @submit.prevent="submitform">
                            <p> <h5><u>Free text filter:</u></h5> </p>
                            <div align="center">
                            <div class="ui input">
                                <input v-model="name" type="text"
                                       placeholder="Search for name..."/>
                            </div>
                            <div class="ui input">
                                <input v-model="when" type="text"
                                       placeholder="Search for when..."/>
                            </div>
                            <div class="ui input">
                                <input v-model="where" type="text"
                                       placeholder="Search for where..."/>
                            </div>
                            <div class="ui input">
                                <input v-model="close_contact" type="text"
                                       placeholder="Search for close contact..."/>
                            </div>
                            <div class="ui input">
                                <input v-model="age" type="text"
                                       placeholder="Search for age..."/>
                            </div>
                            <div class="ui input">
                                <input v-model="how_long" type="text"
                                       placeholder="Search for how long..."/>
                            </div>
                            </div>
                            <p> <h5><u>Choices filter:</u></h5>
                            <p> Tested negative case has personal relationship with author of the tweet?
                                <select v-model="relation">
                                <option></option>
                                <option>Yes</option>
                            </select>
                            </p>
                            <p> <h5><u>Time range filter:</u></h5>
                                 Start from <input type="date" v-model="date.start" min="2020-01-15" max="2020-08-26">
                                 End at <input type="date" v-model="date.end" min="2020-01-15" max="2020-08-26">
                             </p>
                            <p> <h5><u> Other setup:</u></h5>
                            How many results you would like to return? <select v-model="top_K">
                                <option>10</option>
                                <option>50</option>
                                <option>100</option>
                                <option>200</option>
                                <option>500</option>
                            </select>
                            </p>
                            <button type="submit">Search</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
		    <div class="col-xs-12 col-md-12 col-sm-12 col-xs-12">
			    <div class="well">
                    <div v-for="(talk, idx) in talks" v-if="talk.status == 'STATUS_MSG'">
                       <h5>[[talk.message]]</h5>
                    </div>
                    <br/>

                    <div v-for="(talk, idx) in talks" v-if="talk.status == 'MERGE'">

                        <button type="button" class="btn btn-primary" data-toggle="collapse" :data-target="'#block-'+idx">
                            <span style="float:left"><b>[[talk.aggre_name]]</b>: [[talk.name]]</span><span style="float: right"> <b>count</b>: [[talk.count]]</span>
                        </button>
                            <div :id="'block-'+idx" class="collapse">
                                <div class="panel-body">
                                <table class="table table-striped table-condensed" style="table-layout:fixed;">
                                    <thead>
                                    <tr class="row">
                                        <th class="timestamp"> Timestamp </th>
                                        <th class="text"> Representative Tweet </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr v-for="(each_line, idx) in talk.data" class="row">
                                        <td> [[ each_line.timestamp ]] </td>
                                        <td> [[ each_line.text ]] [<a :href="'https://'+[[each_line.tweet_link]]"  target="_blank">original tweet</a>] </td>
                                    </tr>
                                    <tr v-for="(each_line, idx) in talk.search_query" class="row">
                                        <td></td>
                                      <td><a :href="'http://kb1.cse.ohio-state.edu:8000/covid19/show_complete_'+[[each_line.search_query]]" target="_blank">See all tweets</a></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="panel-body">
                        <div v-for="(talk, idx) in talks" v-if="talk.status == 'SINGLE'">
                        <table class="table table-striped table-condensed" style="table-layout:fixed;">
                            <thead>
                            <tr class="row">
                                <th class="timestamp"> Timestamp </th>
                                <th class="text"> Representative Tweet </th>
                            </tr>
                            </thead>

                            <tbody>
                            <tr v-for="(each_line, idx) in talk.data" class="row">
                                <td> [[ each_line.timestamp ]] </td>
                                <td> [[ each_line.text ]] [<a :href="'https://'+[[each_line.tweet_link]]"  target="_blank">original tweet</a>]</td>
                            </tr>
                            </tbody>
                        </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


    <script src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/lodash"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>

    <script>
        new Vue({
            el: '#app',
            delimiters: ['[[', ']]'],
            data: {
                name: '',
                when: '',
                where: '',
                close_contact: '',
                age: '',
                how_long: '',
                relation: '',
                top_K: '100',
                date: {start: '2020-01-15', end: '2020-08-26'},
                talks: [],
            },
            methods: {
                submitform() {
                    axios.get('/api/covid19/', {
                        params: {
                            q: "negative" + ";" + this.name + ";" + this.when + ";" + this.where + ";" + this.close_contact + ";" + this.age + ";" + this.how_long + ";" + this.relation + ";" + this.date.start + ";" + this.date.end + ";" + this.top_K
                        }
                    }).then(res => {this.talks = res.data})
                }
            }
        })
    </script>

</body>

<!----------------------------------- OTHER STUFF -------------------------------------->
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" rel="stylesheet" />

<style class="darkreader darkreader--sync" media="screen" type="text/css">
</style>

<!-- Open internal style sheet -->
<style type="text/css">
    table {
  width: 100%;
}
    th.timestamp{
      width: 15%
    }
    th.text {
      width: 85%; /* Not necessary, since only 70% width remains */
    }


    #collapseTrigger{
	/*color:#fff;*/
	display: block;
	text-decoration: none;
}
#exampleColTrigger{
	/*color:#fff;*/
	display: block;
	text-decoration: none;
}
#submitButton{
	white-space: normal;
}
#instructionBody table{
	font-size: 14px;
	margin-top: 10px;
}
#instructionBody table caption{
	text-align: left;
	padding: 0 0 5px 0;
}
#exampleBody table{
	font-size: 14px;
	margin-top: 10px;
}
#exampleBody table caption{
	text-align: left;
	padding: 0 0 5px 0;
}
#Inputs{
	display: block;
	margin-top: 10px;
}
.content{
	margin-bottom: 15px;
}
.radio:first-of-type{
	margin-top: -5px;
}
.empty {
	padding:10px 0
}
.alignLeft{
	text-align: left;
}
.question{
	background-color:#d7d7d7;
	font-size:17px;
	font-family:verdana,geneva,sans-serif;
}
.btn{
    background: whitesmoke;
    color: black;
	width: 100%;
}
</style>
<!-- Close internal style sheet -->
<!-- External JS references -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js"
		integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="
		crossorigin="anonymous">
</script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
		integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
		crossorigin="anonymous">
</script>